for k=1:10
    X1(k)=0;
end
H=eye(10);
landa=1;
D=1000;
while(D>0.001)
    for k=1:10
    F(k)=2*(1./k.*X1(k).^2+k.*X1(k)+k.^2)*(2./k.*X1(k)+k);
    end
    A=[1,0,1,0,1,0,1,0,1,0;
       0,1,0,2,0,3,0,4,0,5;
       0,2,0,0,-5,0,0,8,0,0;
       -1,0,-1,0,-1,0,-1,0,-1,0;
       0,-1,0,-2,0,-3,0,-4,0,-5;
       0,-2,0,0,-5,0,0,-8,0,0;
       1,0,0,-3,0,0,5,0,1,-1;
       1,2,0,4,0,0,0,8,0,0;
       1,0,3,0,0,6,0,0,-9,0;
       1,0,0,0,0,0,0,0,0,0;
       0,1,0,0,0,0,0,0,0,0;
       0,0,1,0,0,0,0,0,0,0;
       0,0,0,1,0,0,0,0,0,0;
       0,0,0,0,1,0,0,0,0,0;
       0,0,0,0,0,1,0,0,0,0;
       0,0,0,0,0,0,1,0,0,0;
       0,0,0,0,0,0,0,1,0,0;
       0,0,0,0,0,0,0,0,1,0;
       0,0,0,0,0,0,0,0,0,1;
       -1,0,0,0,0,0,0,0,0,0;
       0,-1,0,0,0,0,0,0,0,0;
       0,0,-1,0,0,0,0,0,0,0;
       0,0,0,-1,0,0,0,0,0,0;
       0,0,0,0,-1,0,0,0,0,0;
       0,0,0,0,0,-1,0,0,0,0;
       0,0,0,0,0,0,-1,0,0,0;
       0,0,0,0,0,0,0,-1,0,0;
       0,0,0,0,0,0,0,0,-1,0;
       0,0,0,0,0,0,0,0,0,-1;];
   b=[-0.9*(X1(1)+X1(3)+X1(5)+X1(7)+X1(9));
      -0.9*(X1(2)+2*X1(4)+3*X1(6)+4*X1(8)+5*X1(10));
      -0.9*(2*X1(2)-5*X1(5)+8*X1(8));
       0.9*(X1(1)+X1(3)+X1(5)+X1(7)+X1(9));
       0.9*(X1(2)+2*X1(4)+3*X1(6)+4*X1(8)+5*X1(10));
       0.9*(2*X1(2)-5*X1(5)+8*X1(8));
       -X1(1)+3*X1(4)-5*X1(7)+X1(10);
       -X1(1)-2*X1(2)-4*X1(4)-8*X1(8)+100;
       -X1(1)-3*X1(3)-6*X1(6)+9*X1(9)+50;
        1000-X1(1);
        1000-X1(2);
        1000-X1(3);
        1000-X1(4);
        1000-X1(5);
        1000-X1(6);
        1000-X1(7);
        1000-X1(8);
        1000-X1(9);
        1000-X1(10);
        1000+X1(1);
        1000+X1(2);
        1000+X1(3);
        1000+X1(4);
        1000+X1(5);
        1000+X1(6);
        1000+X1(7);
        1000+X1(8);
        1000+X1(9);
        1000+X1(10);];
    S=qpdantz(H,F,A,b);
     M=X1;
    L1=F+landa*([4,5,4,3,-4,9,6,20,-8,4]); 
    syms a
    for k=1:10
        f(k)=2*(1./k.*(X1(k)+a*S(k)).^2+k.*(X1(k)+a*S(k))+k.^2)*(2./k.*(X1(k)+a*S(k))+k).*S(k);
    end
    f1=sum(f);
    R(1)=S(1)+S(3)+S(5)+S(7)+S(9);
    R(2)=S(2)+2*S(4)+3*S(6)+4*S(8)+5*S(10);
    R(3)=2*S(2)-5*S(5)+8*S(8);
    v=1000;
    z=1000;
    while(z>.0001)
    if X1(1)-3*X1(4)+5*X1(7)-X1(10)<=0
        R(4)=0;
    else
        R(4)=S(1)-3*S(4)+5*S(7)-S(10);
    end
     if X1(1)+2*X1(2)+4*X1(4)+8*X1(8)-100<=0
        R(5)=0;
    else
        R(5)=S(1)+2*S(2)+4*S(4)+8*S(8);
     end
     if X1(1)+3*X1(3)+6*X1(6)-9*X1(9)-50<=0
     R(6)=0;
    else
        R(6)=S(1)+3*S(3)+6*S(6)-9*S(9);
     end
     for k=1:10
         if X1(k)-1000<=0
            R(6+k)=0;
         else
             R(6+k)=S(k);
         end
     end
     for k=1:10
         if -X1(k)-1000<=0
            R(16+k)=0;
         else
             R(16+k)=-S(k);
         end
     end
     al=solve(f1+landa*sum(R),a);
     alph=subs(al);
     alpha=alph(1);
    for k=1:10
         X2(k)=X1(k)+alpha*S(k);
    end
    X1=X2;
    z=abs(alpha-v);
    v=alpha;
    end
     for k=1:10
         P(k)=X2(k)-M(k);
     end
     landa=2*landa;  
     for k=1:10
    F(k)=2*(1./k.*X2(k).^2+k.*X2(k)+k.^2)*(2./k.*X2(k)+k);
     end
    L2=F+landa*([4,5,4,3,-4,9,6,20,-8,4]); 
     Q=L2-L1;
     if P*transpose(Q)>=0.2*P*H*transpose(P)
         teta=1;
     else
         teta=(0.8*P*H*transpose(P))/(P*H*transpose(P)-P*transpose(Q));
     end
     gama=teta*transpose(Q)+(1-teta)*H*transpose(P);
     H=H-(H*transpose(P)*P*H)/(P*H*transpose(P))+gama*transpose(gama)/(P*transpose(P));
     for k=1:10
         D1=(X2(k)-M(k)).^2;
     end
     D=sqrt(sum(D1));
     X1=X2;
     end
       